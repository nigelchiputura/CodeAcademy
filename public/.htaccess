RewriteEngine On

# ----------------------------------------
# 1. Block access to sensitive files
# ----------------------------------------

# Block .env files
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>

# Block Composer files
<FilesMatch "(composer\.json|composer\.lock|package\.json|package-lock\.json)">
    Require all denied
</FilesMatch>

# Block config folders, app folder, system files
RewriteRule ^app(/.*)?$ - [F,L]
RewriteRule ^core(/.*)?$ - [F,L]
RewriteRule ^vendor(/.*)?$ - [F,L]
RewriteRule ^storage(/.*)?$ - [F,L]

# ----------------------------------------
# 2. Allow access ONLY to public assets
# ----------------------------------------
RewriteRule ^assets/ - [L]
RewriteRule ^uploads/ - [L]
RewriteRule ^css/ - [L]
RewriteRule ^js/ - [L]
RewriteRule ^images/ - [L]

# ----------------------------------------
# 3. Route everything else to index.php
# ----------------------------------------
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]
